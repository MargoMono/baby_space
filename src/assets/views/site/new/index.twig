<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" prefix="og: http://ogp.me/ns#">
<head>
    <title>KDF trading</title>
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    {% include 'site/includes/head.twig' %}
    <link rel="stylesheet" type="text/css" href="/assets/css/site/index.css">
</head>
<body>

{% include 'site/includes/header.twig' %}


<div class="simple-page article">
    <div class="title">
        <h2>Новости компании</h2>
    </div>

    <div class="content articles">
        <div class="articles-list">
            {% for new in newList %}
                <div class="block">
                    <div class="image">
                        <a href="/new/{{ new.alias|e }}/{{ new.id|e }}">
                            <img src="/upload/images/new/{{ new.file_alias|e }}" alt="" class="article-image"/>
                        </a>
                    </div>
                    <div class="text">
                        <div class="title">
                            <a href="/new/{{ new.alias|e }}/{{ new.id|e }}">
                                <h3>{{ new.name|e }} </h3>
                                <p>{{ new.created_at|e }}</p>
                            </a>
                        </div>
                        <div class="description">{{ new.description|e }}</div>
                        <a href="/new/{{ new.alias|e }}/{{ new.id|e }}" class="read-more-link">Читать дальше...</a>
                    </div>
                </div>
            {% endfor %}
        </div>

        <a class="button show_more" href="/new">Показать еще</a>
    </div>
</div>

{% include 'site/includes/callbackform.twig' %}
{% include 'site/includes/footer.twig' %}

<script>
  $(function() {
    $('.show_more').click(function(e) {
        e.preventDefault();
      let newsCount = $('.articles-list .block').length;
      $.ajax({
        url: '/new/show-more/' + newsCount,
        type: 'GET',
        success: function(res) {
          $('.articles-list').append(res);
        },
        error: function() {
        },
      });
    });
  });

  $(document).ready(function() {
    let lastPage = {{ lastPage }};
    if (lastPage) {
      $('.show_more').hide();
    }
  });
</script>
{% include 'admin/includes/header.twig' %}

<div class="content-wrapper">
    <section class="content-header">
        <h1>
            Панель администратора
            <small>Добавить категорию</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="/admin/category/">Категории товаров</a></li>
            <li class="active">Добавить категорию</li>
        </ol>
    </section>

    <section class="content">
        {% if errors is not empty %}
            <div class="col-lg-12 mistake">
                <p>Ошибка:</p>
                <ul>
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        <div class="col-lg-12 correct">
            <div class="login-form">
                <form action="/admin/category/update/{{ category.id }}" enctype="multipart/form-data" method="post">

                    <input type="hidden" name="id" placeholder="" value="{{ category.id }}">

                    {% if category.parent_id != 0 %}
                        <p class="title-name">Родительская категория</p>
                        <p>*максимальный уровень вложенности - 3</p>
                        <p>*нельзя создать базовый уровень вложенности</p>
                        <select name="parent">
                            {% for key, categoryItem in categoryList %}
                                {% if categoryItem.id == category.parent_id %}
                                    <option value="{{ category.parent_id }}" selected="selected">{{ categoryItem.breadcrumbs }}</option>
                                {% else %}
                                    <option value="{{ categoryItem.id }}">{{ categoryItem.breadcrumbs }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    {% else %}
                        <input type="hidden" name="parent" placeholder="" value="{{ category.parent_id }}">
                    {% endif %}

                    <p class="title-name">Название</p>
                    <input type="text" name="name" placeholder="" value="{{ category.name }}" required>
                    <p class="required">*обязательное поле</p>

                    <p class="title-name">Описание</p>
                    <textarea id="summernote" name="description">{{ category.description }}</textarea>

                    <input type="hidden" name="file_id" placeholder="" value="{{ category.file_id }}">
                    <input type="hidden" name="file_alias" placeholder="" value="{{ category.file_alias }}">

                    <p class="title-name">Изображение</p>
                    <img src="/upload/images/category/{{ category.file_alias }}" width="150" alt=""/>
                    <input type="file" name="file" value="">

                    <p class="title-name">Изображения для галереи</p>
                    {% for photo in categoryFilesList %}
                        {% if photo.file_alias is not empty %}
                        <img src="/upload/images/category/{{ photo.file_alias }}" width="150" alt=""/>
                        <a href="/admin/category/photo/delete/{{ category.id }}/{{ photo.file_id }}" title="Удалить"><i class="fa fa-times"></i></a>
                        <br><br>
                        {% endif %}
                    {% endfor %}
                    <input type='file' name='files[]' multiple >

                    <p class="title-name">Статус</p>
                    <select name="enabled">
                        <option value="1" {% if category.enabled == 1 %}selected{% endif %}>Отображается</option>
                        <option value="0" {% if category.enabled == 0 %}selected{% endif %}>Скрыта</option>
                    </select>

                    <p class="title-name">Порядковый номер</p>
                    <input type="text" name="position" placeholder="" value="{{ category.position }}">

                    <p class="title-name">Тэг title</p>
                    <textarea name="tag_title" rows="4" cols="150">{{ category.tag_title }}</textarea>

                    <p class="title-name">Тэг description</p>
                    <textarea name="tag_description" rows="4" cols="150">{{ category.tag_description }}</textarea>

                    <p class="title-name">Тэг keywords</p>
                    <textarea name="tag_keywords" rows="4" cols="150">{{ category.tag_keywords }}</textarea>
                    <br><br>
                    <input type="submit" name="button" class="btn btn-default" value="Обновить"/>
                </form>
            </div>
        </div>
    </section>
</div>

{% include 'admin/includes/footer.twig' %}

<script>

    console.log($('input[type="file"]').prop('files'))
</script>
{% include 'admin/includes/header.twig' %}

<link rel="stylesheet" href="/assets/css/admin/tabs.css">

<div class="content-wrapper">
    <section class="content-header">
        <div class="pull-right">
            <a href="/admin/order" data-toggle="tooltip" title="Вернуться" class="btn btn-stile"><i
                        class="fa fa-reply"></i></a></div>
        <h1>Заказ № {{ order.id }}</h1>
    </section>
    <section class="content">
        <div class="panel panel-default">
            {% if error_warning %}
                <div class="alert alert-danger alert-dismissible"><i
                            class="fa fa-exclamation-circle"></i> {{ error_warning }}
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                </div>
            {% endif %}
            {% if success %}
                <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                </div>
            {% endif %}
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-pencil"></i>Просмотр информации о заказe</h3>
            </div>
            <div class="panel-body">
                <fieldset>
                    <legend>Общая информация о заказе</legend>
                    <table class="table-admin-small table-bordered table-striped table">
                        <tbody>
                        <tr>
                            <td>Номер заказа</td>
                            <td>{{ order.id }}</td>
                        </tr>
                        <tr>
                            <td>Клиент</td>
                            <td>{{ order.last_name }} {{ order.first_name }}</td>
                        </tr>
                        <tr>
                            <td>Почта</td>
                            <td>{{ order.email }}</td>
                        </tr>
                        <tr>
                            <td>Телефон</td>
                            <td>{{ order.telephone }}</td>
                        </tr>
                        <tr>
                            <td>Страна</td>
                            <td>{{ order.country }}</td>
                        </tr>
                        <tr>
                            <td>Адрес</td>
                            <td>{{ order.postcode }} {{ order.city }} {{ order.address }}</td>
                        </tr>
                        <tr>
                            <td>Способ получения</td>
                            <td>{{ order.shipping_method_name }}</td>
                        </tr>
                        <tr>
                            <td>Способ оплаты</td>
                            <td>{{ order.payment_method_name }}</td>
                        </tr>
                        <tr>
                            <td>Комментарий клиента</td>
                            <td>{{ order.comment }}</td>
                        </tr>
                        <tr>
                            <td><b>Статус заказа</b></td>
                            <td>{{ order.status_name }}</td>
                        </tr>
                        <tr>
                            <td><b>Дата заказа</b></td>
                            <td>{{ order.created_at }}</td>
                        </tr>
                        </tbody>
                    </table>

                    <legend>Товары</legend>

                    <table class="table-admin-medium table-bordered table-striped table ">
                        <tbody>
                        <tr>
                            <th>Название</th>
                            <th>Количество, шт.</th>
                            <th>Цена за 1 шт., руб</th>
                            <th>Скидка, %</th>
                            <th>Общая цена, руб</th>
                        </tr>

                        {% for order in orderProductList %}
                            <tr>
                                <td>{{ order.name }}</td>
                                <td>{{ order.quantity }}</td>
                                <td>{{ order.price }}</td>
                                <td>{{ order.sale }}</td>
                                <td>{{ order.total }}</td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <th colspan="4">Общая стоимость</th>
                            <th>{{ order.total_price }}</th>
                        </tr>
                        </tbody>
                    </table>
                </fieldset>
            </div>
        </div>
    </section>
</div>
{% include 'admin/includes/footer.twig' %}

<script type="text/javascript">
    $('#language a:first').tab('show');
    $('#option a:first').tab('show');
</script>

<script type="text/javascript">

    // order recommendations
    const recommendationSelect = document.querySelector('#input-recommendation');

    recommendationSelect.addEventListener('change', () => {
        let index = recommendationSelect.options.selectedIndex;
        let text = recommendationSelect.options[index].text;
        let value = recommendationSelect.options[index].value;

        if (value == 'default') {
            return;
        }

        $('#order-recommendation' + value).remove();
        $('#order-recommendation-list').append('<div id="order-recommendation' + value + '"><i class="fa fa-minus-circle"></i> ' + text + '<input type="hidden" name="order_recommendation[]" value="' + value + '" /></div>');

    });

    $('#order-recommendation-list').delegate('.fa-minus-circle', 'click', function () {
        $(this).parent().remove();
    });

</script>


<script>
    $(document).ready(function () {
        $('#summernote_{{ language.id }}').summernote({
            height: 200,                 // set editor height
            minHeight: null,             // set minimum height of editor
            maxHeight: null,             // set maximum height of editor
            focus: true                  // set focus to editable area after initializing summernote
        });
    });
</script>



{% include 'admin/includes/header.twig' %}

<div class="content-wrapper">
    <section class="content-header">
        <h1>
            Панель администратора
            <small>Отзывы</small>
        </h1>
        <ol class="breadcrumb">
            <li class="active">Отзывы</li>
        </ol>
    </section>

    <section class="content">
        <h4>Список отзывов</h4>
        {% if errors is not empty %}
            <div class="col-lg-12 mistake">
                <p>Ошибка:</p>
                <ul>
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        <table class="table-bordered table-striped table">
            <tr>
                <th>Номер
                    <form action="/admin/comments" method="post">
                        <input type="hidden" name="order" value="id">
                        <input type="submit" class="btn btn-filter" value="&darr;">
                    </form>
                </th>
                <th>Родительский отзыв
                    <form action="/admin/comments" method="post">
                        <input type="hidden" name="order" value="parent_id">
                        <input type="submit" class="btn btn-filter" value="&darr;">
                    </form>
                </th>
                <th>Имя, почта клиента
                    <form action="/admin/comments" method="post">
                        <input type="hidden" name="order" value="user_name">
                        <input type="submit" class="btn btn-filter" value="&darr;">
                    </form>
                </th>
                <th>Тема отзыва
                    <form action="/admin/comments" method="post">
                        <input type="hidden" name="order" value="description">
                        <input type="submit" class="btn btn-filter" value="&darr;">
                    </form>
                </th>
                <th>Текст отзыва
                </th>
                <th>
                </th>
            </tr>
            {% for comment in commentList %}
                <tr>
                    <td>{{ comment.id }}</td>
                    <td>{{ comment.parent_id }}</td>
                    <td>{{ comment.user_name }} </br> {{ comment.user_email }}</td>
                    <td>{{ comment.description }}</td>
                    <td>
                        {% for photo in comment.photos %}
                            <a href="/upload/images/comment/{{ photo.file_alias|e }}">
                                <img class="comment_img" src="/upload/images/comment/{{ photo.file_alias|e }}" alt=""/>
                            </a>
                        {% endfor %}
                        </br>
                        {{ comment.content }}
                    </td>
                    <td>
                        {% if comment.allow == 0 %}<b>Не опубликован</b>
                            <br>
                            <br>
                            <a href="/admin/comments/publish/{{ comment.id }}" class="btn btn-default back">
                                <i class="fa fa-check"></i> Опубликовать
                            </a>
                        {% elseif comment.parent_id is empty %} <b>Опубликован</b>
                            <br>
                            <br>
                            <a href="/admin/comments/create/{{ comment.id }}" class="btn btn-default back">
                                <i class="fa fa-times"></i> Ответить
                            </a>
                        {% endif %}
                        <br>
                        <br>
                        <a href="/admin/comments/delete/{{ comment.id }}" class="btn btn-default back">
                            <i class="fa fa-times"></i> Удалить
                        </a>
                    </td>
                </tr>
            {% endfor %}
        </table>
    </section>
</div>

{% include 'admin/includes/footer.twig' %}

